version: "2"

services:
    postgres:
        image: postgres:16.1
        container_name: postgres
        hostname: postgres
        restart: unless-stopped
        ports:
          - "5432:5432"
        environment:
          - TZ=Europe/Moscow
          - POSTGRES_USER=postgres
          - POSTGRES_PASSWORD=postgres
          - POSTGRES_DB=postgres
        volumes:
          - ./docker/postgres/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d
          - postgres_data:/var/lib/postgresql/data:z
        command: [ "postgres", "-c", "log_statement=all", "-c", "wal_level=logical" ]

    clickhouse:
        image: clickhouse/clickhouse-server:24.3.2.23-alpine
        container_name: clickhouse
        hostname: clickhouse
        restart: unless-stopped
        ports:
          - "8123:8123"
 #         - "9000:9000"
        volumes:
          - clickhouse_data:/var/lib/clickhouse:z
          - ./docker/clickhouse/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d:z
        ulimits:
            nofile:
              soft: 262144
              hard: 262144

volumes:
    postgres_data:
    clickhouse_data:


